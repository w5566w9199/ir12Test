<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <title>各項收入占學校總收入比</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <!-- jQuery v1.9.1 -->
    <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
    <!-- jquery-loading v1.3.0 -->
    <link href="https://cdn.jsdelivr.net/npm/jquery-easy-loading@1.3.0/dist/jquery.loading.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/jquery-easy-loading@1.3.0/dist/jquery.loading.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
        crossorigin="anonymous"></script>
</head>

<body>
    <div class="col-12" style="padding-left: 10px; padding-right: 10px;">
        <h2 style="text-align:center;">國立臺中科技大學校務基金 收入明細表 中華民國110年度</h2>
        <table class="table table-hover">
            <tr style="color:white; background-color: #343a40;">
                <th>科目</th>
                <th>金額</th>
                <th>收入比</th>
            </tr>
        </table>
    </div>
    <script>
        var data = [{ "科目": "學雜費收入(扣除減免81,620,775元)", "金額": 587897719 },
        { "科目": "建教合作收入", "金額": 138207050 },
        { "科目": "推廣教育收入", "金額": 6029947 },
        { "科目": "權利金收入", "金額": 559087 },
        { "科目": "學校教學研究補助收入", "金額": 965713000 },
        { "科目": "雜項業務收入", "金額": 8479014 },
        { "科目": "利息收入", "金額": 26588679 },
        { "科目": "資產使用及權利金收入", "金額": 49110772 },
        { "科目": "受贈收入", "金額": 7021487 },
        { "科目": "賠(補)償收入", "金額": 2822 },
        { "科目": "違規罰款收入", "金額": 680613 },
        { "科目": "雜項收入", "金額": 8154435 },
        { "科目": "其他補助收入", "金額": 105018782 }];
        data = data.sort(function (a, b) {
            return b["金額"] - a["金額"] //順序反轉
        });

        var sum = 0;
        for (let i = 0; i < data.length; i++) {
            if (isNaN(data[i]["金額"]) === false)
                sum += (data[i]["金額"]);
            else
                sum += 0;
        }

        for (let i = 0; i < data.length; i++) {
            let average = ((data[i]["金額"]) / sum * 100).toFixed(2);
            let tr1 = document.createElement('tr');
            let th1 = document.createElement('th');
            let td1 = document.createElement('td');
            let td2 = document.createElement('td');
            th1.innerText = data[i]["科目"];
            td1.innerText = data[i]["金額"].toLocaleString('en-US');
            td2.innerHTML = average + '&nbsp;%';
            tr1.appendChild(th1);
            tr1.appendChild(td1);
            tr1.appendChild(td2);
            document.getElementsByTagName('tbody')[0].append(tr1);
        }
    </script>
</body>

</html>